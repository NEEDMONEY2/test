<!DOCTYPE html>
<html>

<div class="frame">
	<div class="center">
		<div class="title">
			<h1>Drop file to uploadd</h1>
		</div>
    
    <div class="dropzone">
			<img src="http://100dayscss.com/codepen/upload.svg" class="upload-icon" />
            <!-- onchange="previewImage(event)" 미리보기 옵션-->
      <input type="file" name="image" class="image-input"   id="image-input" >  
    </div>
        <input type="button" class = "btn" value="Detect Objects" onclick="detectObjects()">
        
      
<head>
  <title>Capstone</title>
  <!-- css파일 -->
  <link href="index.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href = https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css>
</head>

<body>
  <!-- <h1><i class="fa-regular fa-folder-arrow-up"style="font-size:100px; color:red"></i></h1> -->

  <form id="image-form" enctype="multipart/form-data">
    


    <img src="#" id="image-preview" style="display:none">
<!-- detect 버튼 -->

    

  </form>
  <div id="result"></div>

    <!-- javascript 파일 -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        function detectObjects() {
            // Get file data from form
            var formData = new FormData();
            var fileInput = document.getElementById('image-input');
            var file = fileInput.files[0];
            formData.append('image', file);

            // Send API request
            $.ajax({
                url: 'http://172.30.1.48:5000/v1/object-detection/yolov5s',
//                 url: 'http://localhost:5000/v1/object-detection/yolov5s',
                type: 'POST',
                data: formData,
                contentType: false,
                processData: false,
                success: function (response) {
                    // Parse JSON response
                    const objects = JSON.parse(response);

                    // Extract class and name fields from objects array
                    const result = objects.map(obj => obj.name);

                    // 결과 도출 (json형식)
                    $('#result').text(`Detection : ${result.join(', ')}`);

                    
                },
                error: function (error) {
                    console.error(error.status);
                    console.error(error.statusText);
                    console.error(error.responseText);
                }
            });
        }

        function previewImage(event) {

            var input = event.target;
            var img = document.getElementById('image-preview');
            img.style.display = "block";
            img.src = URL.createObjectURL(input.files[0]);
        }
    </script>
</body>

</html>

